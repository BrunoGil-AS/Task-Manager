<div class="task-details-container">
  <!-- Sidebar -->
  <app-sidebar class="task-details-sidebar" [mode]="'details'"></app-sidebar>

  <!-- Details Content -->
  <div class="task-details-content">
    <!-- Back Button -->
    <div class="task-details-header">
      <button class="btn-back" (click)="goBack()">
        <span>&larr; Volver</span>
      </button>
    </div>
    @if (loading()) {
      <article class="task-details-card task-details-card--skeleton">
        <div class="details-header">
          <div class="skeleton-line skeleton-line--title"></div>
          <div class="skeleton-pill"></div>
          <div class="details-meta">
            <div class="skeleton-line skeleton-line--sm"></div>
            <div class="skeleton-line skeleton-line--sm"></div>
          </div>
        </div>
        <div class="details-section">
          <div class="skeleton-line"></div>
          <div class="skeleton-line skeleton-line--lg"></div>
          <div class="skeleton-line skeleton-line--lg"></div>
        </div>
        <div class="details-section">
          <div class="skeleton-line skeleton-line--sm"></div>
          <div class="skeleton-line"></div>
        </div>
        <div class="details-actions">
          <div class="skeleton-button"></div>
          <div class="skeleton-button skeleton-button--primary"></div>
        </div>
      </article>
    } @else if (!showForm()) {
      <!-- Task Details Card -->
      <article class="task-details-card" [class.task-details-card--completed]="isCompleted()">
        <!-- Header with Status -->
        <div class="details-header">
          <div class="details-title-section">
            <h2 class="details-title">{{ taskTitle() }}</h2>
            <div class="status-badge" [class.status-badge--completed]="isCompleted()">
              <span class="status-icon">{{ isCompleted() ? 'OK' : '...' }}</span>
              <span class="status-text">{{ isCompleted() ? 'Completada' : 'En progreso' }}</span>
            </div>
          </div>
          <div class="details-meta">
            <div class="meta-item">
              <span class="meta-label">Creada:</span>
              <time class="meta-value">{{ createdAt() | date: 'medium' }}</time>
            </div>
            <div class="meta-item">
              <span class="meta-label">Actualizada:</span>
              <time class="meta-value">{{ updatedAt() | date: 'medium' }}</time>
            </div>
          </div>
        </div>

        <!-- Description Section -->
        <div class="details-section">
          <h3 class="section-title">Descripcion</h3>
          <div class="section-content">
            <p class="description-text">{{ taskDescription() }}</p>
          </div>
        </div>

        <!-- Actions -->
        <div class="details-actions">
          <button class="btn btn-secondary" (click)="toggleComplete()">
            {{ isCompleted() ? 'Marcar como pendiente' : 'Marcar como completada' }}
          </button>
          <button class="btn btn-primary" (click)="editTask()">Editar</button>
        </div>
      </article>
    } @else {
      <app-task-form
        [task]="task()"
        [(showForm)]="showForm"
        [loading]="loading()"
        (onSave)="updateTask($event)"
      ></app-task-form>
    }
  </div>
</div>
